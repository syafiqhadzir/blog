---
layout: post
title: "Biotech Software Testing: Don't Kill Grandma"
date: 2025-04-10
category: QA
slug: biotech-software-testing
gpgkey: "EBE8 BD81 6838 1BAF"
---

## Table of Contents

- [Table of Contents](#table-of-contents)
- [Introduction](#introduction)
- [TL;DR](#tldr)
- [SaMD (Software as a Medical Device)](#samd-software-as-a-medical-device)
- [The FDA and You](#the-fda-and-you)
- [Code Snippet: Formal Verification Concept](#code-snippet-formal-verification-concept)
- [Summary](#summary)
- [Key Takeaways](#key-takeaways)
- [Next Steps](#next-steps)

## Introduction

In typical software: "Move Fast and Break Things."

In Biotech: "Move Slow and Verify Everything or Go To Jail."

Software controls pacemakers, insulin pumps, and MRI machines. A bug in a dating app results in a bad date. A bug in an infusion pump results in an overdose.

QA is not just verifying requirements; it is protecting human life.

## TL;DR

- **Traceability Matrix is mandatory**: Every line of code must trace back to a requirement. Every test must trace back to a risk. If you cannot trace it, delete it.
- **Audit Trail is required**: Who changed that config? When? Why? Digital signatures are mandatory (21 CFR Part 11).
- **Verification vs Validation**: "Did we build the thing right?" (Specs) vs "Did we build the right thing?" (User Needs).

## SaMD (Software as a Medical Device)

Software *is* the device now. AI diagnosing cancer from X-rays. Algorithms dosing insulin.

**QA Strategy**: You cannot fix bugs in production easily. A "Hotfix" requires regulatory approval. A "Rollback" might require surgery.

Therefore, testing is exhaustive. 100% Branch Coverage implies safety, but **Negative Testing** guarantees it.

## The FDA and You

The FDA requires documentation. Lots of it. **510(k)** clearance. **ISO 13485** Quality Management.

If it is not documented, it did not happen. Automated tests are great, but the *report* generated by the test (with time, date, runner) is the legal document.

You need **IQ/OQ/PQ** (Installation Qualification, Operational Qualification, Performance Qualification).

## Code Snippet: Formal Verification Concept

For critical loops (like dosing), unit tests are not enough. You need mathematical certainty (Property Based Testing).

```javascript
/*
  insulin-pump.spec.js
*/
const fc = require('fast-check'); // Property Based Testing library

/**
 * Calculates Insulin Dose.
 * SAFETY CRITICAL: Must never exceed max_dose (10.0 units).
 * Must never be negative.
 */
function calculateDose(currentBg, targetBg) {
  const MAX_DOSE = 10.0;
  let dose = (currentBg - targetBg) / 50; 
  
  // Safety Clamp (The Logic we are testing)
  if (dose > MAX_DOSE) dose = MAX_DOSE;
  if (dose < 0) dose = 0;
  
  return dose;
}

test('calculateDose should NEVER return > MAX_DOSE', () => {
  // Run 1000 random inputs
  fc.assert(
    fc.property(fc.integer(), fc.integer(), (bg, target) => {
      const result = calculateDose(bg, target);
      // Invariant: Result is always safe
      return result <= 10.0 && result >= 0;
    })
  );
});
```

## Summary

Biotech QA is stressful. Your git commit message could be read by a federal auditor.

But it is meaningful. You are the gatekeeper ensuring technology helps rather than harms. Take it seriously. Do not kill Grandma.

## Key Takeaways

- **SOUP requires validation**: Software of Unknown Provenance. Using a third-party library (`npm install left-pad`)? You are responsible for its bugs. You must validate your dependencies.
- **Cybersecurity is critical**: Hacking a heart monitor is a real threat. Pen-test everything. Encryption at rest and in transit is mandatory.
- **Human Factors need testing**: Test the UI with doctors and patients. Is the text readable for elderly eyes? Is the "STOP" button red and huge?

## Next Steps

- **Tool**: Use **fast-check** for Property Based Testing in JS. It finds edge cases you did not think of.
- **Learn**: Read **IEC 62304**. The bible of medical software lifecycle. Sleep with it under your pillow.
- **Audit**: Do you have a "Kill Switch"? If the software goes rogue (infinite loop), can it be stopped hard (Watchdog Timer)?
